<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Lahiri, Furukawa, and Lee (2007) Nonparametric Plug-In "NPPI" Rule to Select the Optimal Block-Length — nppi • blocklength</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Lahiri, Furukawa, and Lee (2007) Nonparametric Plug-In " nppi rule to select the optimal block-length><meta name="description" content="This function implements the Nonparametric Plug-In (NPPI) algorithm,
 as proposed by Lahiri, Furukawa, and Lee (2007), to select the optimal block
 length for block bootstrap procedures.
 The NPPI method estimates the optimal block length by balancing bias and
 variance in block bootstrap estimators, particularly for time series and
 other dependent data structures. The function also leverages the Moving
 Block Bootstrap (MBB) method of (Kunsch, 1989) and the Moving Blocks
 Jackknifte (MBJ) of Liu and Singh (1992)."><meta property="og:description" content="This function implements the Nonparametric Plug-In (NPPI) algorithm,
 as proposed by Lahiri, Furukawa, and Lee (2007), to select the optimal block
 length for block bootstrap procedures.
 The NPPI method estimates the optimal block length by balancing bias and
 variance in block bootstrap estimators, particularly for time series and
 other dependent data structures. The function also leverages the Moving
 Block Bootstrap (MBB) method of (Kunsch, 1989) and the Moving Blocks
 Jackknifte (MBJ) of Liu and Singh (1992)."><meta property="og:image" content="/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">blocklength</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/tuning-parameters.html">Tuning Block-Length Selection Methods</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Alec-Stashevsky/blocklength/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Lahiri, Furukawa, and Lee (2007) Nonparametric Plug-In "NPPI" Rule to Select the Optimal Block-Length</h1>
      <small class="dont-index">Source: <a href="https://github.com/Alec-Stashevsky/blocklength/blob/v0.2.0/R/nppi.R" class="external-link"><code>R/nppi.R</code></a></small>
      <div class="d-none name"><code>nppi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements the Nonparametric Plug-In (NPPI) algorithm,
 as proposed by Lahiri, Furukawa, and Lee (2007), to select the optimal block
 length for block bootstrap procedures.
 The NPPI method estimates the optimal block length by balancing bias and
 variance in block bootstrap estimators, particularly for time series and
 other dependent data structures. The function also leverages the Moving
 Block Bootstrap (MBB) method of (Kunsch, 1989) and the Moving Blocks
 Jackknifte (MBJ) of Liu and Singh (1992).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nppi</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  stat_function <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  a <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  l <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  m <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  num_bootstrap <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  c_1 <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  plots <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A numeric vector, ts, or single-column data.frame representing
the time series or dependent data.</p></dd>


<dt id="arg-stat-function">stat_function<a class="anchor" aria-label="anchor" href="#arg-stat-function"></a></dt>
<dd><p>A function to compute the statistic of interest
(*e.g.*, mean, variance). The function should accept a numeric vector as input
and return a scalar value (default is <code>mean</code>).</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>The rate parameter for the MSE expansion (default is 1). This
parameter controls the convergence rate in the bias-variance trade-off.</p></dd>


<dt id="arg-a">a<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>The bias exponent (default is 1). Adjust this based on the
theoretical properties of the statistic being bootstrapped.</p></dd>


<dt id="arg-l">l<a class="anchor" aria-label="anchor" href="#arg-l"></a></dt>
<dd><p>Optional. The initial block size for bias estimation.
If not provided, it is set to <code>max(2, round(c_1 * n^{1 / (r + 4)}))</code>,
where <code>n</code> is the sample size.</p></dd>


<dt id="arg-m">m<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>Optional. The number of blocks to delete in the
Jackknife-After-Bootstrap (JAB) variance estimation. If not provided,
it defaults to <code>floor(c_2 * n^{1/3} * l^{2/3})</code>.</p></dd>


<dt id="arg-num-bootstrap">num_bootstrap<a class="anchor" aria-label="anchor" href="#arg-num-bootstrap"></a></dt>
<dd><p>The number of bootstrap replications for bias estimation
(default is 1000).</p></dd>


<dt id="arg-c-">c_1<a class="anchor" aria-label="anchor" href="#arg-c-"></a></dt>
<dd><p>A tuning constant for initial block size calculation (default is 1).</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>A small constant added to the variance to prevent division by
zero (default is <code>1e-8</code>).</p></dd>


<dt id="arg-plots">plots<a class="anchor" aria-label="anchor" href="#arg-plots"></a></dt>
<dd><p>A logical value indicating whether to plot the JAB diagnostic</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A object of class <code>nppi</code> with the following components:</p><dl><dt>optimal_block_length</dt>
<dd><p>The estimated optimal block length for the
   block bootstrap procedure.</p></dd>

  <dt>bias</dt>
<dd><p>The estimated bias of the block bootstrap estimator.</p></dd>

  <dt>variance</dt>
<dd><p>The estimated variance of the block bootstrap estimator
   using the JAB method.</p></dd>

  <dt>jab_point_values</dt>
<dd><p>The point estimates of the statistic for each
   deletion block in the JAB variance estimation. Used for diagnostic plots</p></dd>

   <dt>l</dt>
<dd><p>The initial block size used for bias estimation.</p></dd>

   <dt>m</dt>
<dd><p>The number of blocks to delete in the JAB variance estimation.</p></dd>


</dl><p>@section References:</p>
<p>Efron, B. (1992), 'Jackknife-after-bootstrap standard errors and influence
     functions (with discussion)', Journal of Royal Statistical Society,
     Series B 54, 83-111.</p>
<p>Kunsch, H. (1989) The Jackknife and the Bootstrap for General Stationary
     Observations. The Annals of Statistics, 17(3), 1217-1241. Retrieved
     February 16, 2021, from <a href="https://doi.org/10.1214/aos/1176347265" class="external-link">doi:10.1214/aos/1176347265</a></p>
<p>Lahiri, S. N., Furukawa, K., &amp; Lee, Y.-D. (2007). A nonparametric plug-in
     rule for selecting optimal block lengths for Block Bootstrap Methods.
     Statistical Methodology, 4(3), 292-321. DOI:
     <a href="https://doi.org/10.1016/j.stamet.2006.08.002" class="external-link">doi:10.1016/j.stamet.2006.08.002</a></p>
<p>Lahiri, S. N. (2003). 7.4 A Nonparametric Plug-in Method. In Resampling
     methods for dependent data (pp. 186-197). Springer.</p>
<p>Liu, R. Y. and Singh, K. (1992), Moving blocks jackknife and bootstrap
     capture weak dependence, in R. Lepage and L. Billard, eds, 'Exploring
     the Limits of the Bootstrap', Wiley, New York, pp. 225-248.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Jackknife-After-Bootstrap (JAB) variance estimation (Lahiri, 2002).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate AR(1) time series</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">32</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, ar <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        n <span class="op">=</span> <span class="fl">500</span>, innov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate the optimal block length for the sample mean</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">nppi</span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim</span>, stat_function <span class="op">=</span> <span class="va">mean</span>, num_bootstrap <span class="op">=</span> <span class="fl">500</span>, m <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Setting l to recomended value: 3</span>
<span class="r-plt img"><img src="nppi-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">optimal_block_length</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0001767721</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use S3 method to plot JAB diagnostic</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alec Stashevsky.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

