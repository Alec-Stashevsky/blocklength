<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tuning Block-Length Selection Methods • blocklength</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Tuning Block-Length Selection Methods">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">blocklength</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tuning-parameters.html">Tuning Block-Length Selection Methods</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Alec-Stashevsky/blocklength/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tuning Block-Length Selection Methods</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Alec-Stashevsky/blocklength/blob/main/vignettes/tuning-parameters.Rmd" class="external-link"><code>vignettes/tuning-parameters.Rmd</code></a></small>
      <div class="hidden name"><code>tuning-parameters.Rmd</code></div>

    </div>

    
    
<p>This vignette builds a framework for tuning the block-selection
algorithms in <code>blocklength.</code> Both the <span class="citation">Hall, Horowitz, and Jing (1995)</span> (“HHJ”) and
<span class="citation">Politis and White (2004)</span> (“PWSD”) methods
require the user to select somewhat arbitrary parameters which may
affect the reliability of the block-length optimization. We will go
through examples that present <em>problematic</em> output and understand
how to diagnose and remedy these situations under both the HHJ and PWSD
frameworks.</p>
<div class="section level2">
<h2 id="tuning-parameters">Tuning Parameters<a class="anchor" aria-label="anchor" href="#tuning-parameters"></a>
</h2>
<p>This section will discuss the tuning parameters of each optimization
method. Though some parameters are set to a default, often times manual
inspection and adjustments will need to be made to identify and remedy
problematic solutions such as local optima or corner solutions.</p>
<p>An overview of the tuning parameters:</p>
<ol style="list-style-type: lower-alpha">
<li>
<code><a href="../reference/hhj.html">hhj()</a></code>
<ol style="list-style-type: lower-roman">
<li><code>sub_sample</code></li>
<li><code>pilot_block_length</code></li>
</ol>
</li>
<li>
<code><a href="../reference/pwsd.html">pwsd()</a></code>
<ol style="list-style-type: lower-roman">
<li><code>K_N</code></li>
<li><code>M_max</code></li>
<li><code>m_hat</code></li>
<li><code>b_max</code></li>
<li><code>c</code></li>
</ol>
</li>
</ol>
<div class="section level3">
<h3 id="hhj">HHJ<a class="anchor" aria-label="anchor" href="#hhj"></a>
</h3>
<p>The accuracy of <code><a href="../reference/hhj.html">hhj()</a></code> depends on the choice of two
tuning parameters. The first is the size of the subsample series to
perform the cross-validation over. This is the argument
<code>sub_sample</code>, or the parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
in <span class="citation">Hall, Horowitz, and Jing (1995)</span>. At
this stage
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
is unknown, but there are some restrictions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
must follow. Note that <code><a href="../reference/hhj.html">hhj()</a></code> is a computationally intensive
procedure and may take some time, especially as the length of the series
becomes large. Employing parallelization and adjusting the grid search
parameters to streamline the search process may help.</p>
<p>Since <code><a href="../reference/hhj.html">hhj()</a></code> must iterate over multiple subsamples it
must be that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m &lt; n</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is the length of the series provided in argument <code>series</code>,
<em>i.e.</em> <code>length(series)</code>. More specifically, it must be
that</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>m</mi><mo>=</mo><mi>o</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> as </mtext><mspace width="0.333em"></mspace></mrow><mi>n</mi><mo>→</mo><mi>∞</mi><mspace width="0.222em"></mspace><mi>.</mi></mrow><annotation encoding="application/x-tex"> m^{-1} + n^{-1}m  = o(1) \text{ as } n \rightarrow \infty \ . </annotation></semantics></math></p>
<p>As a default, <code>sub_sample = NULL</code> which sets
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><msup><mi>n</mi><mrow><mn>1</mn><mi>/</mi><mn>5</mn></mrow></msup><mo>*</mo><msup><mi>n</mi><mrow><mn>1</mn><mi>/</mi><mi>k</mi></mrow></msup></mrow><annotation encoding="application/x-tex">m = n^{1 / 5} * n^{1 / k}</annotation></semantics></math>
satisfying the above restrictions. Users can override this by directly
setting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
as some numeric constant supplied to <code>subsample.</code> Ideally,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
should be an integer, but <code><a href="../reference/hhj.html">hhj()</a></code> will round this to a whole
number automatically.</p>
<p>Though
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
is almost entirely arbitrary, the second tuning parameter for
<code><a href="../reference/hhj.html">hhj()</a></code> is less so. This is the
<code>pilot_block_length</code> argument, or the parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>
in <span class="citation">Hall, Horowitz, and Jing (1995)</span> also
denoted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>l</mi><mi>n</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">l^{*}_n</annotation></semantics></math>
in the <span class="citation">Lahiri (2003)</span> treatment. The
<code>pilot_block_length</code> is the block-length used to perform the
initial block-bootstrap of <code>series.</code></p>
<p>To reduce the effect of the choice of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>
on the accuracy of the optimization, <code><a href="../reference/hhj.html">hhj()</a></code> replaces
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>
with the previous iteration’s estimate of the optimal block-length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>l</mi><mo>*</mo></msup><annotation encoding="application/x-tex">l^*</annotation></semantics></math>
(or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><msubsup><mi>l</mi><mi>n</mi><mn>0</mn></msubsup><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{l^0_n}</annotation></semantics></math>
in <span class="citation">Lahiri (2003)</span>), repeating until
convergence or the iteration limit implied by <code>n_iter</code> is
reached. The number supplied to <code>pilot_block_length</code> is only
used on the first iteration of <code><a href="../reference/hhj.html">hhj()</a></code> hence it is referred
to as a <em>pilot</em> parameter.</p>
<p>In practice, <code><a href="../reference/hhj.html">hhj()</a></code> estimates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>l</mi><mo>*</mo></msup><annotation encoding="application/x-tex">l^*</annotation></semantics></math>
by minimizing an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MSE</annotation></semantics></math>
function for each possible block-length using a block-bootstrap of a
subsample from <code>series</code> with length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">m.</annotation></semantics></math>
The block-length that minimizes the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MSE</annotation></semantics></math>
on a given subsample is then used to estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>l</mi><mo>*</mo></msup><annotation encoding="application/x-tex">l^*</annotation></semantics></math>
which replaces <code>pilot_block_length</code> for the next iteration.
However, because we minimize the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MSE</annotation></semantics></math>
over a subsample of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>,
we must first scale this block-length back to the original series of
length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">n.</annotation></semantics></math>
This is accomplished by employing the <em>Richardson Extrapolation,</em>
a sequence acceleration technique from numerical analysis first
developed in 1911, <em>see</em> <span class="citation">Richardson and
Glazebrook (1911)</span>.</p>
<p>In this sense, <code><a href="../reference/hhj.html">hhj()</a></code> actually estimates the optimal
block-length of the subsample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>l</mi><mo accent="true">̂</mo></mover><mi>m</mi></msub><annotation encoding="application/x-tex">\hat{l}_m</annotation></semantics></math>
which is then scaled up to the full series such that</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><msub><mover><mi>l</mi><mo accent="true">̂</mo></mover><mi>m</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mi>/</mi><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mi>/</mi><mi>k</mi></mrow></msup><mo>,</mo><mspace width="0.222em"></mspace><mtext mathvariant="normal">where</mtext><mspace width="0.222em"></mspace><mi>k</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>5</mn><mo stretchy="false" form="postfix">}</mo><mspace width="0.222em"></mspace><mo>,</mo></mrow><annotation encoding="application/x-tex">l = \hat{l}_m (n/m)^{1/k}, \ \text{where} \ k = \{3, 4, 5\} \ ,</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
depends on the context of the object of estimation.</p>
</div>
<div class="section level3">
<h3 id="pwsd">PWSD<a class="anchor" aria-label="anchor" href="#pwsd"></a>
</h3>
<p>Like <code><a href="../reference/hhj.html">hhj()</a></code>, the accuracy of <code><a href="../reference/pwsd.html">pwsd()</a></code> is also
subject to a somewhat arbitrary choice of tuning parameters. Unlike the
HHJ method, however, the tuning parameters for <code><a href="../reference/pwsd.html">pwsd()</a></code> deal
exclusively with the way the method adapts to the underlying correlation
structure of the series whereas in <code>hhj(),</code> tuning parameters
set the lengths and sizes from which to cross-validate subsamples. Note
that <code><a href="../reference/pwsd.html">pwsd()</a></code> will set all the tuning parameters to
recommended defaults so that only the argument <code>data</code> must be
supplied.</p>
<p><span class="citation">Politis and White (2004)</span> discuss their
proposed defaults and some techniques to adjust tuning parameters
largely in <em>footnote c</em> on page 59. The first tuning parameter of
<code><a href="../reference/pwsd.html">pwsd()</a></code> is <code>K_N</code>, denoted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>N</mi></msub><annotation encoding="application/x-tex">K_N</annotation></semantics></math>
in <span class="citation">Politis and White (2004)</span>.
<code>K_N</code> takes some integer value that indicates the maximum
number of lags for which to apply the implied hypothesis test over the
correlogram of the series. That is, <code>K_N</code> is the number of
consecutive lags in the correlogram that must appear
<em>insignificant</em> in order to select the optimal bandwidth
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
for the flat-top lag window.</p>
<p><span class="citation">Politis and White (2004)</span> suggest
letting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>2</mn><mover><mi>m</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">M = 2\hat{m}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>m</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{m}</annotation></semantics></math>
is the smallest positive integer such that the following
<code>K_N</code> consecutive lags appear insignificant in respect to
some level of significance, discussed later. By default,
<code>K_N  = NULL</code> which sets
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>N</mi></msub><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>5</mn><mo>,</mo><mo stretchy="false" form="prefix">⌈</mo><mspace width="0.222em"></mspace><msub><mo>log</mo><mn>10</mn></msub><mi>N</mi><mspace width="0.222em"></mspace><mo stretchy="false" form="postfix">⌉</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">K_N = max(5, \lceil \ \log_{10}N \ \rceil)</annotation></semantics></math>
per the suggestion of <span class="citation">Politis and White
(2004)</span>. Note
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>N</mi></msub><annotation encoding="application/x-tex">K_N</annotation></semantics></math>
must be some non-decreasing integer valued function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>N</mi></msub><mo>=</mo><mi>o</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mo>log</mo><mn>10</mn></msub><mi>N</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">K_N = o(\log_{10}N)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
is again the length of the series supplied to <code>data =</code>,
<em>i.e.</em> <code>nrow(data).</code></p>
<p>The next tuning parameter <code>M_max</code> (denoted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">M_{max}</annotation></semantics></math>
below) acts as an upper-bound for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
such that</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>*</mo><mover><mi>m</mi><mo accent="true">̂</mo></mover><mo>&gt;</mo><msub><mi>M</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>⇒</mo><mi>M</mi><mo>=</mo><msub><mi>M</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mspace width="0.222em"></mspace><mi>.</mi></mrow><annotation encoding="application/x-tex">2 * \hat{m} &gt; M_{max} \Rightarrow M = M_{max} \ .</annotation></semantics></math></p>
<p>Thus, <code>M_max</code> allows us to expand or contract the maximum
size of the bandwidth for the flat-top lag windows of <span class="citation">Politis and Romano (1995)</span>. If it is the case
that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>*</mo><mover><mi>m</mi><mo accent="true">̂</mo></mover><mo>&lt;</mo><msub><mi>M</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">2 * \hat{m} &lt; M_{max}</annotation></semantics></math>,
then <em>only</em> changing the value of <code>M_max</code> will not
have an affect on the method’s accuracy.</p>
<p>We can inspect the output of <code><a href="../reference/pwsd.html">pwsd()</a></code> to assess any
interim values that may help us understand how to further tune the
calculation. For example, we can find the value estimated as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>m</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{m}</annotation></semantics></math>
by inspecting the <code>$parameters</code> component of
<code><a href="../reference/pwsd.html">pwsd()</a></code> output objects, <em>i.e.</em> objects where
<code>class = "pwsd".</code></p>
<p>To show this lets first do some housekeeping and attach
<code>blocklength.</code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://alecstashevsky.com/r/blocklength" class="external-link">blocklength</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">32</span><span class="op">)</span></span></code></pre></div>
<p>Now, we generate a stationary
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">AR(1)</annotation></semantics></math>
time series and select an optimal block-length using the PWSD
method:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate an AR(1) simulation</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, ar <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                        n <span class="op">=</span> <span class="fl">500</span>, innov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the PWSD method and suppress output of the correlogram</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pwsd.html">pwsd</a></span><span class="op">(</span><span class="va">sim</span>, correlogram <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect interim parameters</span></span>
<span><span class="va">b</span><span class="op">$</span><span class="va">parameters</span></span>
<span><span class="co">#&gt;        n k        c K_N M_max b_max m_hat M rho_k_critical</span></span>
<span><span class="co">#&gt; [1,] 500 1 1.959964   5    28    68     3 6      0.1439999</span></span></code></pre></div>
<p>Here we can see that <code>m_hat = 3</code> and
<code>M_max = 28</code> so no censoring is occurring.</p>
<p>In certain situations, we may wish to forego the implied hypothesis
test to estimate <code>m_hat</code> and instead set <code>m_hat</code>
directly by supplying some integer to <code>pwsd(m_hat = ).</code> In
general, the implied hypothesis test should not be used unless specific
characteristics are known about the data-generating process of the
underlying series or issues with the correlogram output are present.</p>
<p>The next tuning parameter is <code>b_max =</code> which acts as an
upper-bound for the optimal block-length. This can be extracted from
‘pwsd’ class objects using <code>$BlockLength.</code> If
<code><a href="../reference/pwsd.html">pwsd()</a></code> estimates some value for the optimal block-length
such that <code>b_Stationary &gt; b_max</code> or
<code>b_Circular &gt; b_max</code> then
<code>b_Stationary</code>/<code>b_Circular</code> will be set to
<code>b_max.</code> By default, <code>b_max = NULL</code> which sets
<code>b_max = ceiling(min(3 * sqrt(n), n / 3)).</code> We can inspect
the output of <code><a href="../reference/pwsd.html">pwsd()</a></code> to see if the selected block-lengths
are being censored by <code>b_max.</code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print block-length estimates</span></span>
<span><span class="va">b</span><span class="op">$</span><span class="va">BlockLength</span></span>
<span><span class="co">#&gt;      b_Stationary b_Circular</span></span>
<span><span class="co">#&gt; data     9.327923   10.67781</span></span>
<span></span>
<span><span class="co"># Test if optimal block-length is censored by b_max</span></span>
<span><span class="va">b</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="st">"b_max"</span><span class="op">]</span> <span class="op">==</span> <span class="va">b</span><span class="op">$</span><span class="va">BlockLength</span></span>
<span><span class="co">#&gt;      b_Stationary b_Circular</span></span>
<span><span class="co">#&gt; data        FALSE      FALSE</span></span>
<span></span>
<span><span class="co"># Print the upper-bound</span></span>
<span><span class="va">b</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="st">"b_max"</span><span class="op">]</span></span>
<span><span class="co">#&gt; b_max </span></span>
<span><span class="co">#&gt;    68</span></span></code></pre></div>
<p>Here we can see our optimal block-length is between 8 and 9
observations long. These are far below the default maximum value of
68.</p>
<p>The final tuning parameter for <code><a href="../reference/pwsd.html">pwsd()</a></code> is the argument
<code>c</code> also denoted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
in <span class="citation">Politis and White (2004)</span>. At a
high-level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
acts as a pseudo confidence-level to conduct the implied hypothesis
tests on the series’ correlogram. Thus, it must be that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>&gt;</mo><mn>0</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">c &gt; 0.</annotation></semantics></math>
If the auto-correlation of a given lag
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
is above some critical value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mrow><mi>c</mi><mi>r</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi>a</mi><mi>l</mi></mrow></msub><annotation encoding="application/x-tex">\rho_{critical}</annotation></semantics></math>,
then that lag is considered <em>significant.</em> This critical value is
defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>c</mi><mi>r</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><mi>c</mi><msqrt><mrow><msub><mo>log</mo><mn>10</mn></msub><mi>N</mi><mi>/</mi><mi>N</mi></mrow></msqrt><mi>.</mi></mrow><annotation encoding="application/x-tex">\rho_{critical} = c\sqrt{\log_{10}N / N}.</annotation></semantics></math></p>
<p><span class="citation">Politis and White (2004)</span> suggest a
value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">c = 2</annotation></semantics></math>
but by default, <code><a href="../reference/pwsd.html">pwsd()</a></code> treats
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
as a standard two-tailed 95% confidence interval by setting
<code>c = qnorm(0.975).</code> This is quite close to the suggested
value of 2. Using the correlogram output, either by setting
<code>correlogram = TRUE</code> or using the corresponding
<code>plot</code> method, we can visualize
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mrow><mi>c</mi><mi>r</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>c</mi><mi>a</mi><mi>l</mi></mrow></msub><annotation encoding="application/x-tex">\rho_{critical}</annotation></semantics></math>
as the dashed magenta lines that form the significance bands on the
plot.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print rho_k_critical</span></span>
<span><span class="va">b</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="st">"rho_k_critical"</span><span class="op">]</span></span>
<span><span class="co">#&gt; rho_k_critical </span></span>
<span><span class="co">#&gt;      0.1439999</span></span>
<span></span>
<span><span class="co"># Plot correlogram from previous selection</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, main <span class="op">=</span> <span class="st">"c = qnorm(0.975)"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Expand confidence level and plot again</span></span>
<span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pwsd.html">pwsd</a></span><span class="op">(</span><span class="va">sim</span>, c <span class="op">=</span> <span class="fl">4</span>, correlogram <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b1</span>, main <span class="op">=</span> <span class="st">"c = 4"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="tuning-parameters_files/figure-html/Correlogram-1.svg" width="47%"><img src="tuning-parameters_files/figure-html/Correlogram-2.svg" width="47%"></p>
</div>
</div>
<div class="section level2">
<h2 id="diagnosing-problematic-solutions">Diagnosing Problematic Solutions<a class="anchor" aria-label="anchor" href="#diagnosing-problematic-solutions"></a>
</h2>
<p>Problematic solutions can render block-length selections unreliable
and inconsistent, thus it is important to inspect the interim output of
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MSE</annotation></semantics></math>
function for <code><a href="../reference/hhj.html">hhj()</a></code> and the respective Correlogram output of
<code>pwsd().</code></p>
<div class="section level3">
<h3 id="hhj-1">HHJ<a class="anchor" aria-label="anchor" href="#hhj-1"></a>
</h3>
<p>If <code>plots = TRUE</code> the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MSE</annotation></semantics></math>
function will be plotted and output to the console for each iteration of
the algorithm. If <code>plots = FALSE</code>, then this interim output
will be suppressed; however, users can save the output of
<code><a href="../reference/hhj.html">hhj()</a></code> and then access these plots later by using the
corresponding S3 <code>plot</code> method, just like how we plotted the
output for <code><a href="../reference/pwsd.html">pwsd()</a></code> above.</p>
<p>The main issues that occur with the <code><a href="../reference/hhj.html">hhj()</a></code> optimization
method are solving for local minima or corner solutions of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MSE</annotation></semantics></math>
function. Ideally, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MSE</annotation></semantics></math>
plot will exhibit a convex shape, such as the plot depicted below:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select a block-length using HHJ method</span></span>
<span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hhj.html">hhj</a></span><span class="op">(</span><span class="va">sim</span>, sub_sample <span class="op">=</span> <span class="fl">10</span>, k <span class="op">=</span> <span class="st">"bias/variance"</span>, plots <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Pilot block length is: 3</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">#&gt;   method            from</span></span>
<span><span class="co">#&gt;   as.zoo.data.frame zoo</span></span>
<span><span class="co">#&gt; Performing minimization may take some time</span></span>
<span><span class="co">#&gt; Calculating MSE for each level in subsample: 10 function evaluations required.</span></span>
<span><span class="co">#&gt;  Chosen block length: 11  After iteration: 1</span></span>
<span><span class="co">#&gt;  Converged at block length (l): 11</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b2</span><span class="op">)</span></span></code></pre></div>
<p><img src="tuning-parameters_files/figure-html/Convex%20MSE-1.svg" width="47%"><img src="tuning-parameters_files/figure-html/Convex%20MSE-2.svg" width="47%"></p>
<p>However, this is often times not the case and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MSE</annotation></semantics></math>
plot may appear concave. An example of a <em>problematic</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MSE</annotation></semantics></math>
plot is illustrated below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate a AR(2) simulation</span></span>
<span><span class="va">sim2</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, ar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                        n <span class="op">=</span> <span class="fl">500</span>, innov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select a block-length using HHJ method</span></span>
<span><span class="va">b3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hhj.html">hhj</a></span><span class="op">(</span><span class="va">sim2</span>, plots <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Pilot block length is: 3</span></span>
<span><span class="co">#&gt; Performing minimization may take some time</span></span>
<span><span class="co">#&gt; Calculating MSE for each level in subsample: 12 function evaluations required.</span></span>
<span><span class="co">#&gt;  Chosen block length: 25  After iteration: 1</span></span>
<span><span class="co">#&gt;  Converged at block length (l): 25</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b3</span><span class="op">)</span></span></code></pre></div>
<p><img src="tuning-parameters_files/figure-html/Concave%20MSE-1.svg" width="47%"><img src="tuning-parameters_files/figure-html/Concave%20MSE-2.svg" width="47%"></p>
<p>Here we see the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MSE</annotation></semantics></math>
function is minimized by taking the largest block-length available, in
this case 25. This is problematic because it may be that some larger
block-length is truly optimal. Had we evaluated the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MSE</annotation></semantics></math>
over a larger range of possible block-lengths, this may have been
captured. Similarly, it may be that the smallest (leftmost) block-length
is found to minimize the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MSE</annotation></semantics></math>
function.</p>
<p>This is the main issue with concavity. Such plots often indicate that
the solution reached is some local minimum, and that changing the tuning
parameters of <code><a href="../reference/hhj.html">hhj()</a></code> will likely lead to a new and equally
unreliable estimate.</p>
<p>In such cases, it may help to shrink the <code>sub_sample</code>
size,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">m.</annotation></semantics></math>
As discussed previously the choice of <code>pilot_block_length</code> is
less important but users are encouraged to try a range of combinations
for the tuning parameters. It may be the case that no permutation of
<code>pilot_block_length</code> and <code>sub_sample</code> produce a
convex
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">MSE</annotation></semantics></math>
plot. In this situation, users are encouraged to benchmark the results
of <code><a href="../reference/hhj.html">hhj()</a></code> with other methods provided in this package.</p>
</div>
<div class="section level3">
<h3 id="pwsd-1">PWSD<a class="anchor" aria-label="anchor" href="#pwsd-1"></a>
</h3>
<p><span class="citation">Politis and White (2004)</span> are explicit
that manual inspection of the correlogram is necessary, especially in
cases where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>m</mi><mo accent="true">̂</mo></mover><mo>,</mo></mrow><annotation encoding="application/x-tex">\hat{m},</annotation></semantics></math>
and subsequently the optimal block-length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>b</mi><mo accent="true">̂</mo></mover><mrow><mi>o</mi><mi>p</mi><mi>t</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">\hat{b}_{opt},</annotation></semantics></math>
are large. By looking at the correlogram and the significance bands
corresponding to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>±</mo><mspace width="0.222em"></mspace><mi>c</mi><msqrt><mrow><msub><mo>log</mo><mn>10</mn></msub><mi>N</mi><mi>/</mi><mi>N</mi></mrow></msqrt><mo>,</mo></mrow><annotation encoding="application/x-tex">\pm \  c\sqrt{\log_{10}{N}/N},</annotation></semantics></math>
we can asses how sensitive the selection of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>m</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{m}</annotation></semantics></math>
is to the tuning parameters.</p>
<p>Specifically, <span class="citation">Politis and White (2004)</span>
define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>m</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{m}</annotation></semantics></math>
as the smallest integer such that the correlogram remains within the
significance bands for at least
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>N</mi></msub><annotation encoding="application/x-tex">K_N</annotation></semantics></math>
lags <em>after</em> the lag
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>m</mi><mo accent="true">̂</mo></mover><mi>.</mi></mrow><annotation encoding="application/x-tex">\hat{m}.</annotation></semantics></math></p>
<p>To illustrate this, consider a <em>problematic</em> correlogram
arising from an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">AR(1)</annotation></semantics></math>
simulation of 500 observations with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0.3</mn><mspace width="0.222em"></mspace><mo>,</mo></mrow><annotation encoding="application/x-tex">\rho = 0.3 \ ,</annotation></semantics></math>
named <code>pcorr</code> in the code below. Note <code>pcorr</code> has
been loaded behind the scenes so it is not randomly generated each time
the vignette is built.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select a block-length using PWSD method</span></span>
<span><span class="va">b4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pwsd.html">pwsd</a></span><span class="op">(</span><span class="va">pcorr</span>, K_N <span class="op">=</span> <span class="fl">5</span>, correlogram <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b4</span>, main <span class="op">=</span> <span class="st">"Problematic Correlogram"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output m_hat to console</span></span>
<span><span class="va">b4</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="st">"m_hat"</span><span class="op">]</span></span>
<span><span class="co">#&gt; m_hat </span></span>
<span><span class="co">#&gt;     3</span></span></code></pre></div>
<p><img src="tuning-parameters_files/figure-html/Problematic%20Correlogram-1.svg" width="80%" style="display: block; margin: auto;"></p>
<p>If we are to follow the <span class="citation">Politis and White
(2004)</span> rule for estimating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>m</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{m}</annotation></semantics></math>
explicitly where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>N</mi></msub><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">K_N = 5</annotation></semantics></math>,
then it must be that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>m</mi><mo accent="true">̂</mo></mover><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">\hat{m} = 3</annotation></semantics></math>
because 3 is the smallest lag
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
such that the following 5 lags are insignificant (within the dashed
bands). If we were to adjust
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>N</mi></msub><annotation encoding="application/x-tex">K_N</annotation></semantics></math>
slightly and re-estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>m</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{m}</annotation></semantics></math>
once more it would be radically different. For example if we keep
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
as the default <code>qnorm(0.975)</code> but change
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>N</mi></msub><mo>=</mo><mn>6</mn><mo>,</mo></mrow><annotation encoding="application/x-tex">K_N = 6,</annotation></semantics></math>
then we would be led to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>m</mi><mo accent="true">̂</mo></mover><mo>=</mo><mn>9</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">\hat{m} = 9.</annotation></semantics></math></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select block-length using PWSD method</span></span>
<span><span class="va">b5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pwsd.html">pwsd</a></span><span class="op">(</span><span class="va">pcorr</span>, K_N <span class="op">=</span> <span class="fl">6</span>, correlogram <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b5</span>, main <span class="op">=</span> <span class="st">"Problematic Correlogram 2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output m_hat to console</span></span>
<span><span class="va">b5</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="st">"m_hat"</span><span class="op">]</span></span>
<span><span class="co">#&gt; m_hat </span></span>
<span><span class="co">#&gt;     9</span></span></code></pre></div>
<p><img src="tuning-parameters_files/figure-html/Problematic%20Correlogram%202-1.svg" width="80%" style="display: block; margin: auto;"></p>
<p>Alternatively, when we keep
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>N</mi></msub><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">K_N = 5</annotation></semantics></math>
but change
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
to mimic a 99% confidence level by setting
<code>c = qnorm(0.995),</code> we get the following output with much
wider bands of significance:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select a block-length using PWSD method</span></span>
<span><span class="va">b6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pwsd.html">pwsd</a></span><span class="op">(</span><span class="va">pcorr</span>, c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.995</span><span class="op">)</span>, correlogram <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b6</span>, main <span class="op">=</span> <span class="st">"Problematic Correlogram 3"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Output m_hat to console</span></span>
<span><span class="va">b6</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="st">"m_hat"</span><span class="op">]</span></span>
<span><span class="co">#&gt; m_hat </span></span>
<span><span class="co">#&gt;     1</span></span></code></pre></div>
<p><img src="tuning-parameters_files/figure-html/Problematic%20Correlogram%203-1.svg" width="80%" style="display: block; margin: auto;"></p>
<p>Here we can see that moving these significance bands farther apart
changes the estimation to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>m</mi><mo accent="true">̂</mo></mover><mo>=</mo><mn>1</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">\hat{m} = 1.</annotation></semantics></math>
Overall, the sensitivity of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>m</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{m}</annotation></semantics></math>
to the tuning parameters is concerning and users should proceed with
vigilance.</p>
<p>The default tuning parameters for <code><a href="../reference/pwsd.html">pwsd()</a></code> are merely
<em>suggestions,</em> and <span class="citation">Politis and White
(2004)</span> provide a rule-of-thumb when users are faced with
problematic solutions such as the correlograms presented above. They
recommend that users always take into account their experience and any
knowledge of the data set at-hand, but also note that flat-top lag
window spectral estimators preform best with small values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
and that users should favor the smallest or most simple model over a
more complex model with similar explanatory power. In this light, <span class="citation">Politis and White (2004)</span> recommend setting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>m</mi><mo accent="true">̂</mo></mover><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\hat{m} = 1</annotation></semantics></math>
in the presence of an unclear correlogram and lack of reasonable
intuition. Note that <code><a href="../reference/pwsd.html">pwsd()</a></code> will automatically set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>m</mi><mo accent="true">̂</mo></mover><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\hat{m} = 1</annotation></semantics></math>
if there are no significant lags in the correlogram. To accomplish this
manually, we can set <code>M_max = 1</code> to force
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>m</mi><mo accent="true">̂</mo></mover><mo>=</mo><mn>1</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">\hat{m} = 1.</annotation></semantics></math></p>
<p>However, if some knowledge of the underlying data-generating process
is known, we may want to lean on intuition. For example, benchmark
interest rates are often derived from some daily interest rate using a
30-day (or 90-day) compound average. In such circumstances, we may want
to examine at least 30 (90) lags of the correlation structure and
consider completely overriding the estimation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>m</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{m}</annotation></semantics></math>
by setting the argument to <code>m_hat = 30</code> or
<code>m_hat = 90.</code></p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References:<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-10.1093/biomet/82.3.561" class="csl-entry">
Hall, Peter, Joel L. Horowitz, and Bing-Yi Jing. 1995. <span>“<span class="nocase">On blocking rules for the bootstrap with dependent
data</span>.”</span> <em>Biometrika</em> 82 (3): 561–74. <a href="https://doi.org/10.1093/biomet/82.3.561" class="external-link">https://doi.org/10.1093/biomet/82.3.561</a>.
</div>
<div id="ref-lahiri2003resampling" class="csl-entry">
Lahiri, S. K. 2003. <em>Resampling Methods for Dependent Data</em>.
Springer Series in Statistics. Springer. <a href="https://books.google.com/books?id=e4f8sqm439UC" class="external-link">https://books.google.com/books?id=e4f8sqm439UC</a>.
</div>
<div id="ref-https://doi.org/10.1111/j.1467-9892.1995.tb00223.x" class="csl-entry">
Politis, Dimitris N., and Joseph P. Romano. 1995. <span>“Bias-Corrected
Nonparametric Spectral Estimation.”</span> <em>Journal of Time Series
Analysis</em> 16 (1): 67–103. <a href="https://doi.org/10.1111/j.1467-9892.1995.tb00223.x" class="external-link">https://doi.org/10.1111/j.1467-9892.1995.tb00223.x</a>.
</div>
<div id="ref-doi:10.1081/ETC-120028836" class="csl-entry">
Politis, Dimitris N., and Halbert White. 2004. <span>“Automatic
Block-Length Selection for the Dependent Bootstrap.”</span>
<em>Econometric Reviews</em> 23 (1): 53–70. <a href="https://doi.org/10.1081/ETC-120028836" class="external-link">https://doi.org/10.1081/ETC-120028836</a>.
</div>
<div id="ref-doi:10.1098/rsta.1911.0009" class="csl-entry">
Richardson, Lewis Fry, and Richard Tetley Glazebrook. 1911. <span>“IX.
The Approximate Arithmetical Solution by Finite Differences of Physical
Problems Involving Differential Equations, with an Application to the
Stresses in a Masonry Dam.”</span> <em>Philosophical Transactions of the
Royal Society of London. Series A, Containing Papers of a Mathematical
or Physical Character</em> 210 (459-470): 307–57. <a href="https://doi.org/10.1098/rsta.1911.0009" class="external-link">https://doi.org/10.1098/rsta.1911.0009</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alec Stashevsky.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
